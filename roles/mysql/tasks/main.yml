#source common.sh
#
#mysql_root_password=$1
#if [ -z "${mysql_root_password}" ]; then
#echo -e "\e[31mMissing MySQL Root Password argument\e[0m"
#exit 1
#fi
#
#print_head "Disabling MySQL 8 Version"
#dnf module disable mysql -y  &>>${log_file}
#status_check $?
#
#print_head "Copy MySQL repo file"
#cp ${code_dir}/configs/mysql.repo /etc/yum.repos.d/mysql.repo  &>>${log_file}
#status_check $?
#
#print_head "Installing MySQL Server"
#yum install mysql-community-server -y  &>>${log_file}
#status_check $?
#
#print_head "Enable MYSQL Service"
#systemctl enable mysqld  &>>${log_file}
#status_check $?
#
#print_head "Start MySQL Service"
#systemctl start mysqld  &>>${log_file}
#status_check $?
#
#print_head "Set Root Password"
#echo show databases | mysql -uroot -p${mysql_root_password} &>>${log_file}
#if [ $? -ne 0 ]; then
#mysql_secure_installation --set-root-pass ${mysql_root_password}  &>>${log_file}
#fi
#status_check $?

- name: setup mysqlrepo
  ansible.builtin.copy:
    src: mysql.repo
    dest: /etc/yum.repos.d/mysql.repo

- name: Disabling MySQL 8 Version
  ansible.builtin.shell: module disable mysql -y

- name: install Mysql 5.7
  ansible.builtin.yum:
    name: mysql-community-server
    state: installed

- name: Start mysql server
    ansible.builtin.systemd:
      name: mysqld
      state: started
      enabled: yes

- name: Set Root Password
    ansible.builtin.shell: mysql_secure_installation --set-root-pass RoboShop@1